from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QHeaderView
from PyQt5.QtGui import QIcon, QGuiApplication

class Ui_MainWindow:
    def setupUi(self, MainWindow):
        # set the minimum width and height of the MainWindow to 30% and 50% of the available screen resolution.
        screen_res = QGuiApplication.primaryScreen().availableGeometry() # calling men class QGuiapp el method primaryScreen w ba3d availableGeometry
        width, height = screen_res.width() * 0.3, screen_res.height() * 0.5
        MainWindow.setMinimumSize(width, height)

        # set the maximum width and height of the MainWindow to the screen resolution.
        widthm, heightm = screen_res.width(), screen_res.height()
        MainWindow.setMaximumSize(widthm, heightm)

        pixmap = QtGui.QPixmap("gg.png")
        palette = QtGui.QPalette()
        palette.setBrush(QtGui.QPalette.Window, QtGui.QBrush(pixmap))
        MainWindow.setPalette(palette)
        MainWindow.setAutoFillBackground(True)

        icon = QtGui.QIcon("grass.png")
        MainWindow.setWindowIcon(icon)

        self.centralwidget = QtWidgets.QWidget(MainWindow)
        MainWindow.setCentralWidget(self.centralwidget)

        self.gridLayout = QtWidgets.QGridLayout(self.centralwidget) # creating a QGridLayout object and setting it to central widget

        self.level_number = QtWidgets.QSpinBox(self.centralwidget)  # creating a QSpinBox object and setting it to central widget
        self.level_number.setMinimum(1)
        self.level_number.setMaximum(10)
        self.level_number.setFont(QtGui.QFont('Comic Sans MS', 12))
        self.level_number.setAlignment(QtCore.Qt.AlignCenter)  # setting alignment of level number spin box to center
        self.level_number.setMinimumSize(100, 42)
        self.level_number.setPrefix("Level: ")
        self.gridLayout.addWidget(self.level_number, 12, 6, 1, 4)
        self.level_number.setStyleSheet(
            "QSpinBox { padding: 5px; border-radius: 5px; background-color: #F0F8FF; border: 1px solid #000000;}")

        self.new_game_Button = QtWidgets.QPushButton(self.centralwidget)
        self.new_game_Button.setIcon(QtGui.QIcon("restart.png"))
        self.new_game_Button.setToolTip("Reset")
        self.new_game_Button.setFont(QtGui.QFont('Comic Sans MS', 11, QtGui.QFont.Bold))
        self.new_game_Button.setMinimumSize(70, 42)
        self.new_game_Button.clicked.connect(self.on_restart_clicked)
        self.gridLayout.addWidget(self.new_game_Button, 12, 1, 1, 3)
        self.new_game_Button.setStyleSheet("""
            QPushButton {background-color: #F0F8FF;border-style: solid;border-width: 1px;border-radius: 7px;border-color: black;}
            QPushButton:hover {background-color: #FFFFFF;}
            """)

        self.new_random_Button = QtWidgets.QPushButton(self.centralwidget)
        self.new_random_Button.setMinimumSize(30, 42)
        self.new_random_Button.setIcon(QtGui.QIcon("random.png"))
        self.new_random_Button.setToolTip("Randomize")
        self.new_random_Button.setFont(QtGui.QFont('Comic Sans MS', 11, QtGui.QFont.Bold))
        self.new_random_Button.clicked.connect(self.on_random_clicked)
        self.gridLayout.addWidget(self.new_random_Button, 12, 4, 1, 2)
        self.new_random_Button.setStyleSheet("""
            QPushButton {background-color: #F0F8FF;border-style: solid;border-width: 1px;border-radius: 7px;border-color: black;}
            QPushButton:hover {background-color: #FFFFFF;}
             """)

        self.game_field = QtWidgets.QTableView(self.centralwidget)  # creating a QTableView object and setting it to central widget
        self.game_field.horizontalHeader().setVisible(False)  # hiding horizontal header of game field table view
        self.game_field.verticalHeader().setVisible(False)  # hiding vertical header of game field table view
        self.game_field.verticalHeader().setSectionResizeMode(QHeaderView.Stretch)  # resize the header ( field ) to fill all the vertical all available space of the game field widget.
        self.game_field.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)  # resize  the header ( field ) to fill all the horizontal all available space.
        self.gridLayout.addWidget(self.game_field, 1, 1, 1, 9)

        self.textUi(MainWindow)

    def textUi(self, MainWindow):
        MainWindow.setWindowTitle("Цифровой кузнечик")
        self.new_game_Button.setText("Restart")

    def on_restart_clicked(self): # change button background color to green
        self.new_game_Button.setStyleSheet("border-style: solid; border-width: 1px; border-radius: 7px; border-color: black;background-color: #7FFF00;")
        QtCore.QTimer.singleShot(250, self.reset_button_color)     # set a timer to change button background color back to white after 250ms (0.25s)

    def reset_button_color(self): # reset to white
        self.new_game_Button.setStyleSheet("""
            QPushButton {background-color: #FFFFFF;border-style: solid;border-width: 1px;border-radius: 7px;border-color: black;}
            QPushButton:hover {background-color: #E8E8E8;}
            """)

    def on_random_clicked(self): # change to brown
        self.new_random_Button.setStyleSheet("border-style: solid; border-width: 1px; border-radius: 7px; border-color: black;background-color: #FF7256;")
        QtCore.QTimer.singleShot(250, self.reset_random_color)

    def reset_random_color(self): # reset to white
        self.new_random_Button.setStyleSheet("""
            QPushButton {background-color: #FFFFFF;border-style: solid;border-width: 1px;border-radius: 7px;border-color: black;}
            QPushButton:hover {background-color: #E8E8E8;}
            """)
